<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
<title>修改登录密码</title>
<script src="__STATIC__/js/mui.min.js"></script>
<link href="__STATIC__/css/mui.min.css" rel="stylesheet" />
<link href="__STATIC__/css/css.css" rel="stylesheet" />
</head>
<body>
<div class="mui-content">
			<form id='login-form' class="mui-input-group" id="pas_form">
				<div class="mui-input-row login_text">
				  <input type="text" disabled class="login_text" placeholder="{: $user['mobile']}" readonly  id="new_mobile">
				</div>
				<div class="mui-input-row login_text">
                <div class="note"><a href="#">获取验证码</a></div>
				  <input type="text" class="mui-input login_text" placeholder="短信验证码" id="new_code">
				</div>
				<div class="mui-input-row mui-password login_text">
				  <input type="password" class="mui-input-password login_text" placeholder="密码" name="password" id="password">
				</div>
                
			
		  	<div class="login_btn"><a href="javscript:void(0);" onclick="submit_form()">确认提交</a></div>
          	<div class="login_btn1"><a href="my.html">返回</a></div>
			</form>

		</div>
</body>
</html>

<script>
	function submit_form(){ 
		console.log(1);
		if($.trim($('#new_code').val()) == '')  
		{
		alert('验证码不能为空');
		return false;     
		}
		if($('#password').vale() < 6){
			alert('密码长度不能少于6位');
			return false;
		}

		$.ajax({
			type: 'post',
			url:"{: U('Mobile/User/edit_password')}",
			data:{'data':$('#pas_form').serialize()},
			dataType:'json',
			error:function(){
				alert('服务器繁忙, 请联系管理员!');
                return;
			},
			success:function(res){
				console.log(res);
			}

		});
	}

	function a_code(){
		$('#new_code').trigger('click');
	}

	function sendCode(obj,input_id){
        var id = $(obj).attr('id');
        var input = $('#new_mobile').val();


        //发送验证码
        $.ajax({
            type : "get",
            url  : "/index.php?m=Index&c=User&a=send_sms_reg_code&send="+input,
            dataType : 'json',
            error: function(request) {
                console.log(request);
                alert('服务器繁忙, 请联系管理员!');//alert("服务器繁忙, 请联系管理员!");
                return;
            },
            success: function(res) {
              console.log(res);
                if(res.status == 1){
                    jsInnerTimeout(id);
                }else{
                    alert('发送失败');//alert('发送失败');
                }
            }
        });
    }




	//倒计时函数
    function jsInnerTimeout(id)
    {
        var codeObj=$("#"+id);
        var intAs=parseInt(codeObj.attr("IntervalTime"));

        intAs--;
        codeObj.attr("disabled","disabled");
        if(intAs<=-1)
        {
            codeObj.removeAttr("disabled");
            codeObj.attr("IntervalTime","{: $time}");
            codeObj.val("获取验证码");
            return true;
        }

        codeObj.val(intAs+'s后再次获取');
        codeObj.attr("IntervalTime",intAs);

        setTimeout("jsInnerTimeout('"+id+"')",1000);
    };


</script>